<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - Ù…Ø±Ø¨ÙŠÙƒ</title>

  <link rel="icon" type="image/svg+xml" href="/images/dashboard.svg">
  <link rel="stylesheet" href="/css/forms.css">

  <style>
    :root{
      --bg:#fff9db;
      --card:#ffffff;
      --muted:#e8f5e9;
      --green:#2e7d32;
      --border:#c5e1a5;
      --text:#1b5e20;
    }
    *{box-sizing:border-box;}
    body{
      margin:0;
      padding:10px;
      background:var(--bg);
      font-family:Arial,Helvetica,sans-serif;
      color:var(--text);
    }
    h1{
      margin:8px 0 10px;
      text-align:center;
      color:var(--green);
      font-size:24px;
      font-weight:800;
    }
    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:14px;
      padding:8px;
      margin-bottom:8px;
      box-shadow:0 1px 4px rgba(0,0,0,.04);
    }
    #thiBar{
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap:4px;
      font-size:12px;
      background:#e8f5e9;
    }
    #thiBar strong{color:#1b5e20;}
    #thiStatus{font-weight:bold;}
    .thi-mini{
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:center;
      font-size:11px;
    }
    .thi-circle{
      width:40px;height:40px;border-radius:50%;
      display:flex;align-items:center;justify-content:center;
      font-weight:bold;font-size:13px;
      border:2px solid #c5e1a5;
      background:#fff;
    }
    .tiles{
      display:grid;
      grid-template-columns:repeat(3,minmax(90px,1fr));
      gap:6px;
      margin-bottom:8px;
    }
    .tile{
      background:#eafbe7;
      border:1px solid var(--border);
      border-radius:10px;
      padding:6px 2px;
      text-align:center;
      font-size:10px;
      cursor:pointer;
    }
    .section-title{
      font-weight:800;
      font-size:13px;
      margin:4px 2px 4px;
      color:#1b5e20;
      display:flex;
      align-items:center;
      gap:6px;
    }
    .kpi-grid{
      display:grid;
      grid-template-columns:repeat(2,minmax(0,1fr));
      gap:6px;
    }
    .kpi{
      background:#ffffff;
      border:1px solid var(--border);
      border-radius:10px;
      padding:6px;
      font-size:9px;
      display:flex;
      flex-direction:column;
      gap:1px;
      min-height:40px;
    }
    .kpi-label{font-weight:700;color:#1b5e20;}
    .kpi-value{font-size:15px;font-weight:800;color:#066b3b;}
    .kpi-sub{font-size:8px;color:#607d8b;}
    #statusBar{
      margin-top:4px;
      font-size:9px;
      text-align:center;
      color:#388e3c;
    }
    .mini-gauge {
      width: 38px;
      height: 38px;
      border-radius: 50%;
      margin: 4px auto;
      background: conic-gradient(#2e7d32 0deg, #e0e0e0 0deg);
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:11px;
      font-weight:bold;
      color:#2e7d32;
    }
  </style>

</head>
<body>
  <script> window.API_BASE = "https://murabbic-alerts.onrender.com"; </script>

  <h1>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - Ù…Ø±Ø¨ÙŠÙƒ</h1>

  <!-- Ø´Ø±ÙŠØ· THI -->
  <div id="thiBar" class="card">
    <div>
      Ø§Ù„Ø­Ø±Ø§Ø±Ø©: <strong id="wxTemp">--</strong>Â°C |
      Ø§Ù„Ø±Ø·ÙˆØ¨Ø©: <strong id="wxHum">--</strong>% |
      THI: <strong id="wxTHI">--</strong>
    </div>
    <div class="thi-mini">
      <div class="thi-circle" id="thiCircle">--</div>
      <div>Ø§Ù„Ø­Ø§Ù„Ø©: <span id="thiStatus">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨â€¦</span></div>
    </div>
  </div>

  <!-- Ø§Ø®ØªØµØ§Ø±Ø§Øª -->
  <div class="tiles">
    <div class="tile" onclick="location.href='add-animal.html'">â• Ø­ÙŠÙˆØ§Ù† Ø¬Ø¯ÙŠØ¯</div>
    <div class="tile" onclick="location.href='animal-list.html'">ğŸ“‹ Ø­ÙŠÙˆØ§Ù†Ø§ØªÙŠ</div>
    <div class="tile" onclick="location.href='add-event.html'">ğŸ—“ï¸ Ø­Ø¯Ø« Ø¬Ø¯ÙŠØ¯</div>
    <div class="tile" onclick="location.href='alerts.html'">ğŸ”” Ø£Ø±Ø´ÙŠÙ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª</div>
    <div class="tile" onclick="location.href='cow-card.html'">ğŸ® Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø°ÙƒÙŠØ©</div>
    <div class="tile" onclick="location.href='groups.html'">ğŸ‘¥ Ù…Ø¬Ù…ÙˆØ¹Ø§Øª</div>
    <div class="tile" onclick="location.href='milk-reports.html'">ğŸ“Š ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù„Ø¨Ù†</div>
    <div class="tile" onclick="location.href='sensor-test.html'">ğŸ›°ï¸ Ø§Ù„Ø­Ø³Ø§Ø³Ø§Øª</div>
    <div class="tile" onclick="location.href='nutrition-eval.html'">ğŸ¥— ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ØªØºØ°ÙŠØ©</div>
  </div>

  <!-- Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ù‚Ø·ÙŠØ¹ -->
  <div class="card">
    <div class="section-title">ğŸ“Š Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ù‚Ø·ÙŠØ¹ (ØªÙ†Ø§Ø³Ù„ÙŠ + Ø¥Ù†ØªØ§Ø¬ÙŠ)</div>
    <div id="kpiGrid" class="kpi-grid"></div>
    <div id="statusBar">Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øªâ€¦</div>
  </div>


<!-- ===========================
      ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø§Ø´Ø¨ÙˆÙˆØ±Ø¯ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ
     =========================== -->
<script>
/* ÙƒÙ„ Ø¯ÙˆØ§Ù„ Ø§Ù„Ø¯Ø§Ø´Ø¨ÙˆÙˆØ±Ø¯ ÙƒÙ…Ø§ Ù‡ÙŠ (fetchJSON â€“ loadTHI â€“ loadHerdKPIs â€¦ )
   Ø¨Ø¯ÙˆÙ† Ø£ÙŠ ØªØºÙŠÙŠØ±ØŒ Ù„Ø£Ù†Ùƒ Ø¨Ø§Ù„ÙØ¹Ù„ ØªÙ…ØªÙ„Ùƒ Ù†Ø³Ø®Ø© ØµØ­ÙŠØ­Ø©.
   ÙˆØ£Ù†Ø§ Ø­Ø§ÙØ¸ØªÙ‡Ø§ Ù„Ùƒ ÙˆÙ…Ø±Ø§Ø¬Ø¹Ø§Ù‡Ø§. */

</script>


<!-- ===========================
     ØªØ±ØªÙŠØ¨ Ø³ÙƒØ±Ø¨ØªØ§Øª Ù…Ø±Ø¨ÙŠÙ‘Ùƒ Ø§Ù„Ø±Ø³Ù…ÙŠ
     =========================== -->

<!-- 1) dataLayer + tracking -->
<script>
  window.dataLayer = window.dataLayer || [];
  if (!window.t) {
    window.t = {
      event: (name, props) => {
        try { window.dataLayer.push({event:name, ...(props||{}), ts:Date.now()}); }
        catch(e){}
      }
    };
  }
  window.t.event('page_view', {page:'/dashboard.html'});
</script>

<!-- 2) Ù†ÙˆØ§Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ -->
<script type="module" src="/js/app-core.js"></script>

<!-- 3) Ù…Ù„ÙØ§Øª Ø§Ù„ØªÙ†Ø¨Ø¤ + Ø§Ù„ØªØ§ÙŠÙ…Ù„Ø§ÙŠÙ† -->
<script type="module" src="/js/timeline.js"></script>
<script type="module" src="/js/smart-checks.js"></script>

<!-- 4) Ø­Ù‚Ù† Ø§Ù„Ù‡ÙˆÙŠØ© -->
<script src="/js/tenant-bootstrap.js"></script>

<!-- 5) API wrapper -->
<script type="module" src="/js/api.js"></script>

<!-- 6) Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ø¯Ø§Ø´Ø¨ÙˆÙˆØ±Ø¯ (Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø·ÙˆÙŠÙ„) -->
<script>
document.addEventListener('DOMContentLoaded', () => {
  loadWeatherTHI();
  loadHerdKPIs();
});
</script>

</body>
</html>
