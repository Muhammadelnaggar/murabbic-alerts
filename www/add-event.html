<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>إضافة حدث</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    body { direction: rtl; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
           background:#fff9db; margin:0; padding:20px; }
    h2 { text-align:center; color:#2e7d32; margin-bottom:20px; }
    .grid { display:grid; grid-template-columns:1fr 1fr; gap:15px; }
    button {
      background:#2e7d32; color:#fff; padding:20px;
      border:none; border-radius:10px; font-size:18px;
      cursor:pointer; width:100%;
    }
    button:hover { background:#1b5e20; }
  </style>
</head>
<body>

  <h2>تسجيل حدث جديد</h2>

  <div class="grid">
    <button onclick="goTo('insemination.html')">🐂 التلقيح</button>
    <button onclick="goTo('vaccination.html')">💉 التحصين</button>
    <button onclick="goTo('pregnancy-diagnosis.html')">🩺 تشخيص الحمل</button>
    <button onclick="goTo('daily-milk.html')">🥛 اللبن اليومي</button>
    <button onclick="goTo('lameness.html')">🐾 العرج</button>
    <button onclick="goTo('mastitis.html')">🍼 التهاب الضرع</button>
    <button onclick="goTo('calving.html')">🐮 الولادة</button>
    <button onclick="goTo('close-up.html')">📅 تحضير للولادة</button>
    <button onclick="goTo('nutrition.html')">🌾 التغذية</button>
  </div>

  <script>
    // قراءة السياق من الرابط أو التخزين
    function getContext() {
      const urlParams = new URLSearchParams(window.location.search);
      const ctx = {
        animalId: urlParams.get("animalId") || localStorage.getItem("lastAnimalId") || "",
        date: urlParams.get("date") || localStorage.getItem("lastEventDate") || new Date().toISOString().slice(0,10)
      };
      // حفظ آخر قيم للسياق
      if (ctx.animalId) localStorage.setItem("lastAnimalId", ctx.animalId);
      if (ctx.date) localStorage.setItem("lastEventDate", ctx.date);
      return ctx;
    }

    const ctx = getContext();

    // دالة بناء الرابط مع تمرير المعطيات
    function buildTargetUrl(page) {
      return `${page}?animalId=${encodeURIComponent(ctx.animalId)}&date=${encodeURIComponent(ctx.date)}`;
    }

    // دالة الانتقال للصفحة
    function goTo(page) {
      location.href = buildTargetUrl(page);
    }
  </script>

</body>
</html>
